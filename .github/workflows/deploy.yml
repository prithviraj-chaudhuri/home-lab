name: Deploy to Homelab
description: Deploy Services to Homelab
run-name: ${{ github.actor }} is running the workflow
on: [push]
jobs:
  run-playbook:
    runs-on: self-hosted
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: prithviraj-chaudhuri/home-lab
          fetch-depth: 0
          path: /tmp

      - name: Copy secrets
        run: cp -r /home/github-runner/secrets /tmp/home-lab/

      - name: Run make setup
        working-directory: /tmp/home-lab
        run: make setup